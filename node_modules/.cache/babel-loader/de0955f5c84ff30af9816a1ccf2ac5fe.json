{"remainingRequest":"C:\\Users\\Lenovo\\Desktop\\vue\\New woods\\testcase\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Lenovo\\Desktop\\vue\\New woods\\testcase\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\Lenovo\\Desktop\\vue\\New woods\\testcase\\src\\store\\user.js","dependencies":[{"path":"C:\\Users\\Lenovo\\Desktop\\vue\\New woods\\testcase\\src\\store\\user.js","mtime":1544513679507},{"path":"C:\\Users\\Lenovo\\Desktop\\vue\\New woods\\testcase\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Lenovo\\Desktop\\vue\\New woods\\testcase\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Lenovo\\Desktop\\vue\\New woods\\testcase\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\Lenovo\\\\Desktop\\\\vue\\\\New woods\\\\testcase\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"C:\\\\Users\\\\Lenovo\\\\Desktop\\\\vue\\\\New woods\\\\testcase\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport * as fb from 'firebase';\nimport Vue from 'vue';\n\nvar User = function User(id, email, username) {\n  var isAdmin = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n  var avatar = arguments.length > 4 ? arguments[4] : undefined;\n\n  _classCallCheck(this, User);\n\n  this.id = id;\n  this.email = email;\n  this.username = username;\n  this.isAdmin = isAdmin;\n  this.avatar = avatar;\n};\n\nexport default {\n  state: {\n    user: {},\n    isAuth: false\n  },\n  mutations: {\n    setUser: function setUser(state, payload) {\n      state.user = payload;\n      state.isAuth = true;\n      fb.auth().currentUser.getIdToken().then(function (token) {\n        Vue.cookie.set('profile', token, 1);\n      });\n    },\n    unsetUser: function unsetUser(state) {\n      state.user = {};\n      state.isAuth = false;\n      Vue.cookie.delete('profile');\n    }\n  },\n  actions: {\n    registerUser: function () {\n      var _registerUser = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee(_ref, _ref2) {\n        var commit, email, password, username, avatar;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                commit = _ref.commit;\n                email = _ref2.email, password = _ref2.password, username = _ref2.username, avatar = _ref2.avatar;\n                commit('clearError');\n                commit('setLoading', true);\n                _context.prev = 4;\n                _context.next = 7;\n                return fb.auth().createUserWithEmailAndPassword(email, password);\n\n              case 7:\n                fb.database().ref('users/' + fb.auth().currentUser.uid).set({\n                  username: username,\n                  email: email,\n                  isAdmin: false,\n                  avatar: avatar\n                });\n                commit('unsetUser');\n                commit('setLoading', false);\n                _context.next = 17;\n                break;\n\n              case 12:\n                _context.prev = 12;\n                _context.t0 = _context[\"catch\"](4);\n                commit('setLoading', false);\n                commit('setError', _context.t0.message);\n                throw _context.t0;\n\n              case 17:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[4, 12]]);\n      }));\n\n      return function registerUser(_x, _x2) {\n        return _registerUser.apply(this, arguments);\n      };\n    }(),\n    loginUser: function () {\n      var _loginUser = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2(_ref3, _ref4) {\n        var commit, email, password;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                commit = _ref3.commit;\n                email = _ref4.email, password = _ref4.password;\n                commit('clearError');\n                commit('setLoading', true);\n                _context2.prev = 4;\n                _context2.next = 7;\n                return fb.auth().signInWithEmailAndPassword(email, password);\n\n              case 7:\n                fb.database().ref('users/' + fb.auth().currentUser.uid).on('value', function (snapshot) {\n                  if (snapshot.val()) {\n                    var obj = snapshot.val();\n                    var usernameaa = obj.username;\n                    var isAdmin = obj.isAdmin;\n                    var avatar = obj.avatar;\n                    commit('setUser', new User(fb.auth().currentUser.uid, fb.auth().currentUser.email, usernameaa, isAdmin, avatar));\n                    commit('setLoading', false);\n                  }\n                });\n                _context2.next = 15;\n                break;\n\n              case 10:\n                _context2.prev = 10;\n                _context2.t0 = _context2[\"catch\"](4);\n                commit('setLoading', false);\n                commit('setError', _context2.t0.message);\n                throw _context2.t0;\n\n              case 15:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[4, 10]]);\n      }));\n\n      return function loginUser(_x3, _x4) {\n        return _loginUser.apply(this, arguments);\n      };\n    }(),\n    autoLoginUser: function autoLoginUser(_ref5, payload) {\n      var commit = _ref5.commit;\n      commit('setUser', new User(payload.uid, payload.email));\n      fb.database().ref('users/' + fb.auth().currentUser.uid).on('value', function (snapshot) {\n        if (snapshot.val()) {\n          var obj = snapshot.val();\n          var usernameaa = obj.username;\n          var isAdmin = obj.isAdmin;\n          var avatar = obj.avatar;\n          commit('setUser', new User(payload.uid, payload.email, usernameaa, isAdmin, avatar));\n          commit('setLoading', false);\n        }\n      });\n    },\n    logoutUser: function logoutUser(_ref6) {\n      var commit = _ref6.commit;\n      fb.auth().signOut();\n      commit('unsetUser');\n    }\n  },\n  getters: {\n    user: function user(state) {\n      return state.user;\n    },\n    isUserLoggedIn: function isUserLoggedIn(state) {\n      return state.isAuth !== false;\n    },\n    isUserNotLoggedIn: function isUserNotLoggedIn(state) {\n      return state.isAuth === false;\n    }\n  }\n};",{"version":3,"sources":["C:\\Users\\Lenovo\\Desktop\\vue\\New woods\\testcase\\src\\store\\user.js"],"names":["fb","Vue","User","id","email","username","isAdmin","avatar","state","user","isAuth","mutations","setUser","payload","auth","currentUser","getIdToken","then","token","cookie","set","unsetUser","delete","actions","registerUser","commit","password","createUserWithEmailAndPassword","database","ref","uid","message","loginUser","signInWithEmailAndPassword","on","snapshot","val","obj","usernameaa","autoLoginUser","logoutUser","signOut","getters","isUserLoggedIn","isUserNotLoggedIn"],"mappings":"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","sourcesContent":["import * as fb from 'firebase'\r\nimport Vue from 'vue';\r\nclass User {\r\n    constructor(id, email, username, isAdmin = false, avatar) {\r\n        this.id = id\r\n        this.email = email\r\n        this.username = username\r\n        this.isAdmin = isAdmin\r\n        this.avatar = avatar\r\n    }\r\n}\r\n\r\nexport default {\r\n    state: {\r\n        user: {},\r\n        isAuth: false\r\n    },\r\n    mutations: {\r\n        setUser(state, payload) {\r\n            state.user = payload\r\n            state.isAuth = true\r\n            fb.auth().currentUser.getIdToken().then(token => {\r\n                Vue.cookie.set('profile', token, 1);\r\n            })\r\n        },\r\n        unsetUser(state) {\r\n            state.user = {}\r\n            state.isAuth = false\r\n            Vue.cookie.delete('profile');\r\n        }\r\n    },\r\n    actions: {\r\n        async registerUser({ commit }, { email, password, username, avatar }) {\r\n            commit('clearError')\r\n            commit('setLoading', true)\r\n            try {\r\n                await fb.auth().createUserWithEmailAndPassword(email, password)\r\n                fb.database().ref('users/' + fb.auth().currentUser.uid).set({\r\n                    username: username,\r\n                    email: email,\r\n                    isAdmin: false,\r\n                    avatar: avatar,\r\n                });\r\n                commit('unsetUser')\r\n                commit('setLoading', false)\r\n            } catch (error) {\r\n                commit('setLoading', false)\r\n                commit('setError', error.message)\r\n                throw error\r\n            }\r\n        },\r\n        async loginUser({ commit }, { email, password }) {\r\n            commit('clearError')\r\n            commit('setLoading', true)\r\n            try {\r\n                await fb.auth().signInWithEmailAndPassword(email, password)\r\n                fb.database().ref('users/' +\r\n                    fb.auth().currentUser.uid).on('value', function (snapshot) {\r\n                        if (snapshot.val()) {\r\n                            var obj = snapshot.val();\r\n                            const usernameaa = obj.username;\r\n                            const isAdmin = obj.isAdmin;\r\n                            const avatar = obj.avatar;\r\n                            commit('setUser', new User(fb.auth().currentUser.uid, fb.auth().currentUser.email, usernameaa, isAdmin, avatar))\r\n                            commit('setLoading', false)\r\n                        }\r\n                    });\r\n            } catch (error) {\r\n                commit('setLoading', false)\r\n                commit('setError', error.message)\r\n                throw error\r\n            }\r\n        },\r\n        autoLoginUser({ commit }, payload) {\r\n            commit('setUser', new User(payload.uid, payload.email))\r\n            fb.database().ref('users/' +\r\n                fb.auth().currentUser.uid).on('value', function (snapshot) {\r\n                    if (snapshot.val()) {\r\n                        var obj = snapshot.val();\r\n                        const usernameaa = obj.username;\r\n                        const isAdmin = obj.isAdmin;\r\n                        const avatar = obj.avatar;\r\n                        commit('setUser', new User(payload.uid, payload.email, usernameaa, isAdmin, avatar))\r\n                        commit('setLoading', false)\r\n                    }\r\n                });\r\n        },\r\n        logoutUser({ commit }) {\r\n            fb.auth().signOut()\r\n            commit('unsetUser')\r\n        }\r\n    },\r\n    getters: {\r\n        user(state) {\r\n            return state.user\r\n        },\r\n        isUserLoggedIn(state) {\r\n            return state.isAuth !== false\r\n        },\r\n        isUserNotLoggedIn(state) {\r\n            return state.isAuth === false\r\n        }\r\n    }\r\n}\r\n"]}]}